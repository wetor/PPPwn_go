package exploit

import (
	"github.com/wetor/PPPwn_go/internal/config"
	"github.com/wetor/PPPwn_go/internal/utils"
	"testing"
)

func TestExploit_Run(t *testing.T) {
	e := NewExploit(&Option{
		Interface: "\\Device\\NPF_{D1D879E5-534F-4CAA-A2EE-B6DF33437A09}",
		Inject: &config.Inject{
			TargetMAC:  "c8:63:f1:82:20:c7",
			Firmware:   "950",
			Stage1File: "../../testdata/stage1/stage1.bin",
			Stage2File: "../../testdata/stage2/stage2.bin",
		},
	})
	utils.TimeBeginPeriod()
	defer utils.TimeEndPeriod()
	e.Run()

}
